# user-permissions

**Используемыей технологический стек:**

Python 3.12, Django 5.1.1, DRF (Django REST framework), API, JWT, PostgreSQL

## Описание проекта.

* В проекте реализована возможность регистрации пользователей по API; аутентификация пользователей по email и паролю с получением JWT-токенов доступа (аналог Login), в дальнейшем аутентификация проходит по JWT-токену; выход из аккаунта (аналог Logout) с добавлением refresh-токена в черный список; реализовано мягкое удаление аккаунта для пользователей, при этом пользователь не удаляется из системы, а помечается, как is_active=True; так же каждый аутентифицированный пользователь может частично редактировать данные своего аккаунта.
* Для управлением авторизацией созданы дополнительные таблицы, реализована возможность редактирования данных в них через API для администратора.
 

## Система разграничения прав доступа.

Для разграничения прав доступа создано отдельное приложение permissions. Для него созданы 2 модели: BusinessElements и Permissions. Через первую осуществляется контроль за теми приложениями, для которых хотим установить свои ограничения. Вторая отвечает за создание прав доступа к конкретному приложению. В Permissions указываются приложения из модели BusinessElements и возможные роли пользователей, список которых ограничен 4 видами: ``guest``, ``user``, ``manager``, ``admin``. Для каждой роли и конкретного приложения устанавливаются следующие типы ограничений типа BoleanField: ``get_list_permission``, ``create_obj_permission``, ``get_obj_permission``, ``update_obj_permission``, ``partial_update_obj_permission``, ``delete_obj_permission``, ``owner_permission``.

Предполагается, что система разграничений будет основана на сопоставлении запрашиваемого метода запроса и допустимого для конкретного представления в приложении, кроме того, должна идти проверка того, что указанные выше типы ограничений разрешены, то есть имеют значения ``True``, для конкретной роли пользователя. У зарегистрированного пользователя по умолчанию создается роль ``guest``, но затем ему можно присвоить другие роли. В этом случае будет происходить перебор по существующим ролям и выставленным в них правам доступа. Возможна организация авторизации с ограничением по конкретной роля/ролям. Везде, где требуется авторизация, изначально пользователь, отправивший запрос, аутентифицируется (проверяется ``is_authenticated``). Для доступа к редактированию ролей пользователей и системе проверки прав доступа добавлена возможность обращения пользователя ``superuser``, который может не иметь соответвующих разрешений на выполнение каких-либо действий в соответсвии со своей ролью.

Для системы выдачи прав доступа в нынешней реализации в папке каждого приложения созданы файлы ``permissions``. В них для каждой view-функции, связанной с этим приложением, созданы права доступа к объектам, к которым обращается данное представление. Кроме основных функций для работы проекта, добавлено тестовое представление, к которому можно обратиться по пути: ``http://127.0.0.1:8000/api/v1/mock-view/``, если проект запущен на локальном сервере. И для пользователей ``test_guest@mail.ru``, ``test_user@mail.ru``, ``test_manager@mail.ru``, ``test_admin@mail.ru`` возможно проверить наличие доступа по указанному адресу для различных типов запроса. Пароль для этих пользователей в базе данных ``test2025``.


## Установка. 
### Запуск проекта на локальной машине.


Клонировать репозиторий и перейти в него в командной строке:

```
git clone https://github.com/dankut25/user-permissions.git
```

```
cd user-permissions
```

Cоздать и активировать виртуальное окружение:

```
python -m venv venv
```

```
source venv/Scripts/activate
```

Обновить установщик pip:

```
python -m pip install --upgrade pip
```

Установить зависимости из файла requirements.txt:

```
pip install -r requirements.txt
```

Перейти в папку проекта:

```
cd user_permissions
```

Загрузить базу данных на запущенный сервер PostgreSQL:



Выполнить миграции:
```
python manage.py migrate
```

Запустить проект:

```
python manage.py runserver
```

### Доступ к проекту и Админ-панели находятся по адресу:

```
http://127.0.0.1:8000
```
```
http://127.0.0.1:8000/admin
```
